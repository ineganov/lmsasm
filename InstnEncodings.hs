module InstnEncodings (instn_lookup, opcode_map, is_jump) where

import Data.Map (fromList, lookup, Map)
import Data.Word

instn_lookup :: String -> Word8
instn_lookup s = from_maybe (Data.Map.lookup s opcode_map)
                 where from_maybe (Just val) = val
                       from_maybe  Nothing   = error $ "This instruction is not found: " ++ s

is_jump :: String -> Bool
is_jump ('j':'r':_) = True
is_jump _           = False

opcode_map ::Map String Word8
opcode_map = fromList [ ("error",             0x0),
                        ("nop",               0x1),
                        ("program_stop",      0x2),
                        ("program_start",     0x3),
                        ("object_stop",       0x4),
                        ("object_start",      0x5),
                        ("object_trig",       0x6),
                        ("object_wait",       0x7),
                        ("return",            0x8),
                        ("call",              0x9),
                        ("object_end",        0xa),
                        ("sleep",             0xb),
                        ("program_info",      0xc),
                        ("label",             0xd),
                        ("probe",             0xe),
                        ("do",                0xf),
                        ("add8",              0x10),
                        ("add16",             0x11),
                        ("add32",             0x12),
                        ("addf",              0x13),
                        ("sub8",              0x14),
                        ("sub16",             0x15),
                        ("sub32",             0x16),
                        ("subf",              0x17),
                        ("mul8",              0x18),
                        ("mul16",             0x19),
                        ("mul32",             0x1a),
                        ("mulf",              0x1b),
                        ("div8",              0x1c),
                        ("div16",             0x1d),
                        ("div32",             0x1e),
                        ("divf",              0x1f),
                        ("or8",               0x20),
                        ("or16",              0x21),
                        ("or32",              0x22),
                        ("and8",              0x24),
                        ("and16",             0x25),
                        ("and32",             0x26),
                        ("xor8",              0x28),
                        ("xor16",             0x29),
                        ("xor32",             0x2a),
                        ("rl8",               0x2c),
                        ("rl16",              0x2d),
                        ("rl32",              0x2e),
                        ("init_bytes",        0x2f),
                        ("move8_8",           0x30),
                        ("move8_16",          0x31),
                        ("move8_32",          0x32),
                        ("move8_f",           0x33),
                        ("move16_8",          0x34),
                        ("move16_16",         0x35),
                        ("move16_32",         0x36),
                        ("move16_f",          0x37),
                        ("move32_8",          0x38),
                        ("move32_16",         0x39),
                        ("move32_32",         0x3a),
                        ("move32_f",          0x3b),
                        ("movef_8",           0x3c),
                        ("movef_16",          0x3d),
                        ("movef_32",          0x3e),
                        ("movef_f",           0x3f),
                        ("jr",                0x40),
                        ("jr_false",          0x41),
                        ("jr_true",           0x42),
                        ("jr_nan",            0x43),
                        ("cp_lt8",            0x44),
                        ("cp_lt16",           0x45),
                        ("cp_lt32",           0x46),
                        ("cp_ltf",            0x47),
                        ("cp_gt8",            0x48),
                        ("cp_gt16",           0x49),
                        ("cp_gt32",           0x4a),
                        ("cp_gtf",            0x4b),
                        ("cp_eq8",            0x4c),
                        ("cp_eq16",           0x4d),
                        ("cp_eq32",           0x4e),
                        ("cp_eqf",            0x4f),
                        ("cp_neq8",           0x50),
                        ("cp_neq16",          0x51),
                        ("cp_neq32",          0x52),
                        ("cp_neqf",           0x53),
                        ("cp_lteq8",          0x54),
                        ("cp_lteq16",         0x55),
                        ("cp_lteq32",         0x56),
                        ("cp_lteqf",          0x57),
                        ("cp_gteq8",          0x58),
                        ("cp_gteq16",         0x59),
                        ("cp_gteq32",         0x5a),
                        ("cp_gteqf",          0x5b),
                        ("select8",           0x5c),
                        ("select16",          0x5d),
                        ("select32",          0x5e),
                        ("selectf",           0x5f),
                        ("system",            0x60),
                        ("port_cnv_output",   0x61),
                        ("port_cnv_input",    0x62),
                        ("note_to_freq",      0x63),
                        ("jr_lt8",            0x64),
                        ("jr_lt16",           0x65),
                        ("jr_lt32",           0x66),
                        ("jr_ltf",            0x67),
                        ("jr_gt8",            0x68),
                        ("jr_gt16",           0x69),
                        ("jr_gt32",           0x6a),
                        ("jr_gtf",            0x6b),
                        ("jr_eq8",            0x6c),
                        ("jr_eq16",           0x6d),
                        ("jr_eq32",           0x6e),
                        ("jr_eqf",            0x6f),
                        ("jr_neq8",           0x70),
                        ("jr_neq16",          0x71),
                        ("jr_neq32",          0x72),
                        ("jr_neqf",           0x73),
                        ("jr_lteq8",          0x74),
                        ("jr_lteq16",         0x75),
                        ("jr_lteq32",         0x76),
                        ("jr_lteqf",          0x77),
                        ("jr_gteq8",          0x78),
                        ("jr_gteq16",         0x79),
                        ("jr_gteq32",         0x7a),
                        ("jr_gteqf",          0x7b),
                        ("info",              0x7c),
                        ("strings",           0x7d),
                        ("memory_write",      0x7e),
                        ("memory_read",       0x7f),
                        ("ui_flush",          0x80),
                        ("ui_read",           0x81),
                        ("ui_write",          0x82),
                        ("ui_button",         0x83),
                        ("ui_draw",           0x84),
                        ("timer_wait",        0x85),
                        ("timer_ready",       0x86),
                        ("timer_read",        0x87),
                        ("bp0",               0x88),
                        ("bp1",               0x89),
                        ("bp2",               0x8a),
                        ("bp3",               0x8b),
                        ("bp_set",            0x8c),
                        ("math",              0x8d),
                        ("random",            0x8e),
                        ("timer_read_us",     0x8f),
                        ("keep_alive",        0x90),
                        ("com_read",          0x91),
                        ("com_write",         0x92),
                        ("sound",             0x94),
                        ("sound_test",        0x95),
                        ("sound_ready",       0x96),
                        ("input_sample",      0x97),
                        ("input_device_list", 0x98),
                        ("input_device",      0x99),
                        ("input_read",        0x9a),
                        ("input_test",        0x9b),
                        ("input_ready",       0x9c),
                        ("input_readsi",      0x9d),
                        ("input_readext",     0x9e),
                        ("input_write",       0x9f),
                        ("output_get_type",   0xa0),
                        ("output_set_type",   0xa1),
                        ("output_reset",      0xa2),
                        ("output_stop",       0xa3),
                        ("output_power",      0xa4),
                        ("output_speed",      0xa5),
                        ("output_start",      0xa6),
                        ("output_polarity",   0xa7),
                        ("output_read",       0xa8),
                        ("output_test",       0xa9),
                        ("output_ready",      0xaa),
                        ("output_position",   0xab),
                        ("output_step_power", 0xac),
                        ("output_time_power", 0xad),
                        ("output_step_speed", 0xae),
                        ("output_time_speed", 0xaf),
                        ("output_step_sync",  0xb0),
                        ("output_time_sync",  0xb1),
                        ("output_clr_count",  0xb2),
                        ("output_get_count",  0xb3),
                        ("output_prg_stop",   0xb4),
                        ("file",              0xc0),
                        ("array",             0xc1),
                        ("array_write",       0xc2),
                        ("array_read",        0xc3),
                        ("array_append",      0xc4),
                        ("memory_usage",      0xc5),
                        ("filename",          0xc6),
                        ("read8",             0xc8),
                        ("read16",            0xc9),
                        ("read32",            0xca),
                        ("readf",             0xcb),
                        ("write8",            0xcc),
                        ("write16",           0xcd),
                        ("write32",           0xce),
                        ("writef",            0xcf),
                        ("com_ready",         0xd0),
                        ("com_readdata",      0xd1),
                        ("com_writedata",     0xd2),
                        ("com_get",           0xd3),
                        ("com_set",           0xd4),
                        ("com_test",          0xd5),
                        ("com_remove",        0xd6),
                        ("com_writefile",     0xd7),
                        ("mailbox_open",      0xd8),
                        ("mailbox_write",     0xd9),
                        ("mailbox_read",      0xda),
                        ("mailbox_test",      0xdb),
                        ("mailbox_ready",     0xdc),
                        ("mailbox_close",     0xdd) ]
